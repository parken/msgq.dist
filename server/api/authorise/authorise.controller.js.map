{"version":3,"sources":["api/authorise/authorise.controller.js"],"names":["index","handleError","res","argStatusCode","err","statusCode","status","send","req","findOne","where","client_id","query","redirect_uri","attributes","then","model","json","error","catch"],"mappings":";;;;;QAgBgBA,K,GAAAA,K;;AAPhB;;AAEA,SAASC,WAAT,CAAqBC,GAArB,EAA0BC,aAA1B,EAAyCC,GAAzC,EAA8C;AAC5C,MAAMC,aAAaF,iBAAiB,GAApC;AACA,SAAOD,IAAII,MAAJ,CAAWD,UAAX,EAAuBE,IAAvB,CAA4BH,GAA5B,CAAP;AACD,C,CAdD;;;;;;;;;AAgBO,SAASJ,KAAT,CAAeQ,GAAf,EAAoBN,GAApB,EAAyB;AAC9B,SAAO,WAAIO,OAAJ,CAAY;AACjBC,WAAO;AACLC,iBAAWH,IAAII,KAAJ,CAAUD,SADhB;AAELE,oBAAcL,IAAII,KAAJ,CAAUC;AAFnB,KADU;AAKjBC,gBAAY,CAAC,IAAD,EAAO,MAAP;AALK,GAAZ,EAOJC,IAPI,CAOC,UAACC,KAAD,EAAW;AACf,QAAI,CAACA,KAAL,EAAY,OAAOd,IAAII,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB,EAAEC,OAAO,gBAAT,EAArB,CAAP;AACZ,WAAOhB,IAAIe,IAAJ,CAASD,KAAT,CAAP;AACD,GAVI,EAWJG,KAXI,CAWE;AAAA,WAAOlB,YAAYC,GAAZ,EAAiB,GAAjB,EAAsBE,GAAtB,CAAP;AAAA,GAXF,CAAP;AAYD","file":"authorise.controller.js","sourcesContent":["/**\n * Using Rails-like standard naming convention for endpoints.\n * GET     /api/authorise              ->  index\n * POST    /api/authorise              ->  create\n * GET     /api/authorise/:id          ->  show\n * PUT     /api/authorise/:id          ->  update\n * DELETE  /api/authorise/:id          ->  destroy\n */\n\nimport { App } from '../../conn/sqldb';\n\nfunction handleError(res, argStatusCode, err) {\n  const statusCode = argStatusCode || 500;\n  return res.status(statusCode).send(err);\n}\n\nexport function index(req, res) {\n  return App.findOne({\n    where: {\n      client_id: req.query.client_id,\n      redirect_uri: req.query.redirect_uri,\n    },\n    attributes: ['id', 'name'],\n  })\n    .then((model) => {\n      if (!model) return res.status(404).json({ error: 'Invalid Client' });\n      return res.json(model);\n    })\n    .catch(err => handleError(res, 500, err));\n}\n"]}