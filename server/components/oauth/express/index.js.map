{"version":3,"sources":["components/oauth/express/index.js"],"names":["a","routes","app","oauth","all","grant","auth","logout","get","post","authCodeGrant","req","callback","body","allow","user","default","use","errorHandler"],"mappings":";;;;;;kBAIe,UAAUA,CAAV,EAAaC,MAAb,EAAqB;AAClC,MAAMC,MAAMF,CAAZ;AACAE,MAAIC,KAAJ;AACA;AACAD,MAAIE,GAAJ,CAAQ,cAAR,EAAwBF,IAAIC,KAAJ,CAAUE,KAAV,EAAxB;AACAH,MAAIE,GAAJ,CAAQ,eAAR,EAAyBE,KAAKC,MAA9B;AACAL,MAAIE,GAAJ,CAAQ,kBAAR,EAA4BF,IAAIC,KAAJ,CAAUE,KAAV,EAA5B;;AAEA;;AAEA;AACAH,MAAIM,GAAJ,CAAQ,YAAR;;AAEAN,MAAIO,IAAJ,CAAS,YAAT,EAAuBP,IAAIC,KAAJ,CAAUO,aAAV,CAAwB,UAACC,GAAD,EAAMC,QAAN,EAAmB;AAChE,QAAID,IAAIE,IAAJ,CAASC,KAAT,KAAmB,MAAvB,EAA+B,OAAOF,SAAS,IAAT,EAAe,KAAf,CAAP;AAC/B,WAAOA,SAAS,IAAT,EAAe,IAAf,EAAqBD,IAAII,IAAzB,CAAP;AACD,GAHsB,CAAvB;AAIA;AACAd,SAAOe,OAAP,CAAed,GAAf;AACAA,MAAIe,GAAJ,CAAQf,IAAIC,KAAJ,CAAUe,YAAV,EAAR;AACD,C;;AAxBD;;IAAYZ,I;;AACZ;;;;AACA","file":"index.js","sourcesContent":["import * as auth from '../auth';\nimport authorise from './authorise';\nimport oAuth from './../';\n\nexport default function (a, routes) {\n  const app = a;\n  app.oauth = oAuth;\n  // OAuth Token authorization_code, password, refresh_token\n  app.all('/oauth/token', app.oauth.grant());\n  app.all('/oauth/revoke', auth.logout);\n  app.all('/api/oauth/token', app.oauth.grant());\n\n  // app.use(app.oauth.authorise('main'));\n\n  // OAuth Authorise from Third party applications\n  app.get('/authorise', authorise);\n\n  app.post('/authorise', app.oauth.authCodeGrant((req, callback) => {\n    if (req.body.allow !== 'true') return callback(null, false);\n    return callback(null, true, req.user);\n  }));\n  // OAuth Authorise from Third party applications\n  routes.default(app);\n  app.use(app.oauth.errorHandler());\n}\n"]}